#include <stdio.h>
#include <stdlib.h>
#include <string.h>

// Prototypes

void show_help(const char *progname);

// Code

void show_help(const char *progname) {
  printf("Usage: %s [file] [options]\n", progname);
  printf("Options:\n");
  printf("  -h, --help            Show this message.\n");
  printf("  -d DIR, --dest DIR    Output putrefied file to DIR.\n");
}

typedef struct options_t {
  const char *dest;
} options_t;

int main(const int argc, const char **argv) {
  if (argc < 2) {
    printf("File required. Type %s -h for more information.\n", argv[0]);
    return EXIT_FAILURE;
  }

  options_t options;

  int i;
  for (i = 2; i < argc; i++) {
    if (strncmp(argv[i], "-h", 2) == 0
	|| strncmp(argv[i], "--help", 6) == 0) {
      show_help(argv[0]);
      return EXIT_SUCCESS;
    }
    
    if (strncmp(argv[i], "-d", 2) == 0
	|| strncmp(argv[i], "--dest", 6) == 0) {
      options.dest = argv[++i];
    }
  }

  const char* path = argv[1];

  printf("File: '%s', Options: dest=%s\n", path, options.dest);

  return EXIT_SUCCESS;
}
